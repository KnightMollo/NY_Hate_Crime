[
["data-transformation.html", "Chapter 3 Data transformation", " Chapter 3 Data transformation We saved the original data as a csv file called ‘Hate_Crimes_by_County_and_Bias_Type_Beginning_2010.csv’. To get the tidy data, we first dropped the last three columns namely Total.Incidents, Total.Victims, Total.Offenders, as we can still calculate them using the remaining data. Then we regarded columns County, Year and Crime.Type as ID columns, which means we don’t make changes on them. We used the pivot_longer method to gather the rest of columns to create two columns Subtype and Count. Here Subtype means each small class of hate crimes such as Anti.Male, Anti.Female etc. Count is the corresponding number of cases for each small class. After that, we created a new column Type, containing six general classes that are Anti.Gender, Anti.Age, Anti.Race, Anti.Religion, Anti.Sexual.Minority and Anti.Disability. For each Subtype, it has a corresponding type. For example, the Subtype Anti.Female is related with the type Anti.Gender and the Subtype Anti.White is related with the type Anti.Race’. We use the for-loop to fill in the Type column for all rows. dataset &lt;- read.csv(&quot;Hate_Crimes_by_County_and_Bias_Type__Beginning_2010.csv&quot;) dataset &lt;- subset(dataset, select=-c(42,43,44)) names(dataset)[1] &lt;- &quot;County&quot; data&lt;- dataset %&gt;% pivot_longer(cols = !(colnames(dataset)[1] | colnames(dataset)[2] | colnames(dataset)[3]), names_to = &quot;Subtype&quot;, values_to = &quot;Count&quot;) anti_gender = colnames(dataset)[4:7] anti_age = colnames(dataset)[8] anti_race = colnames(dataset)[9:15] anti_religion = colnames(dataset)[16:34] anti_sexual_minority = colnames(dataset)[35:39] anti_disability = colnames(dataset)[40:41] vec = c(rep(0,nrow(data))) data &lt;- cbind(data, Type = vec) for( i in 1:nrow(data)){ if(data$`Subtype`[i] %in% anti_gender){ data$Type[i] = &quot;Anti.Gender&quot; } if(data$`Subtype`[i] %in% anti_age){ data$Type[i] = &quot;Anti.Age&quot; } if(data$`Subtype`[i] %in% anti_race){ data$Type[i] = &quot;Anti.Race&quot; } if(data$`Subtype`[i] %in% anti_religion){ data$Type[i] = &quot;Anti.Religion&quot; } if(data$`Subtype`[i] %in% anti_sexual_minority){ data$Type[i] = &quot;Anti.Sexual.Minority&quot; } if(data$`Subtype`[i] %in% anti_disability){ data$Type[i] = &quot;Anti.Disability&quot; } } Here are first few rows of our modified data. And we save our modified data as a csv file called ‘Hate_Crimes_data_Tidy.csv’. ## County Year Crime.Type Subtype Count ## 1 Albany 2018 Crimes Against Persons Anti.Male 0 ## 2 Albany 2018 Crimes Against Persons Anti.Female 0 ## 3 Albany 2018 Crimes Against Persons Anti.Transgender 0 ## 4 Albany 2018 Crimes Against Persons Anti.Gender.Identity.Expression 0 ## 5 Albany 2018 Crimes Against Persons Anti.Age. 0 ## 6 Albany 2018 Crimes Against Persons Anti.White 1 ## Type ## 1 Anti.Gender ## 2 Anti.Gender ## 3 Anti.Gender ## 4 Anti.Gender ## 5 Anti.Age ## 6 Anti.Race "]
]
